# - name: create roboshop user
#   ansible.builtin.user:
#     name: roboshop
#     shell: /sbin/nologin
#     system: true
#     home: /app
  
# - name: create directory
#   ansible.builtin.file:
#     path: /app
#     state: directory

# - name: download the application file
#   ansible.builtin.get_url:
#     url: https://roboshop-artifacts.s3.amazonaws.com/catalogue-v3.zip
#     dest: /tmp/catalogue.zip

# # here this module thinks the file already existed in ansible server, why becasue we are executing this yaml code in ansible server, so it thinks like that and it thinks that file needs to extract on remote server(catalouge server)
# - name: unzip the downloaded zip file
#   ansible.builtin.unarchive:
#     src: /tmp/catalogue.zip
#     dest: /app
#     remote_src: yes #it will tell that file already existed in catalogue server. If we wont't give this, then we will get error.



- name: create app directory
  ansible.builtin.file:
    path: /app
    state: directory

- name: create roboshop system user
  ansible.builtin.user:
    name: roboshop
    shell: /sbin/nologin
    system: true
    home: /app

- name: "download {{ component }} code"
  ansible.builtin.get_url:
    url: "https://roboshop-artifacts.s3.amazonaws.com/{{ component }}-v3.zip"
    dest: /tmp/{{ component }}.zip

# this module thinks file exist on ansible control server, needs to extract on to remote machine
# remote_src: yes means files already exist in catalogue server
- name: "extract {{ component }} code"
  ansible.builtin.unarchive:
    src: "/tmp/{{ component }}.zip"
    dest: /app
    remote_src: yes